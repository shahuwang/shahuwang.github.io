<!DOCTYPE html>

<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
        <link rel='stylesheet' id='decode-style-css'  href='http://shahuwang.github.io/css/decode.css' type='text/css' media='all' />
        <title>词法分析</title>
         
		<script type="text/x-mathjax-config">
		MathJax.Hub.Config({
			extensions: ["tex2jax.js"],
			jax: ["input/TeX", "output/HTML-CSS"],
			tex2jax:{
				inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
				displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ],
				processEscapes: true
			},
			'HTML-CSS': {availabelFonts: ["TeX"]}
		});
		</script>
		<script type="text/javascript"
  			src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
		</script>
		
		
	</head>
	<body>
		<header id="masthead" class="site-header" role="banner">
		<div class="site-branding">		
			<h1 class="site-title">
			<a href="http://www.shahuwang.com/" title="沙湖王" rel="home">沙湖王</a>
			</h1>				
			<h2 class="site-description">知识只有分享才能延续生命</h2>
		</div>
		</header>
		<p/><p/><p/>
   <h1 class="site-title">词法分析</h1>
		<p/><p/>
        <p>今天想写的是关于词法分析方面的内容，这应该算是编译器开始工作的第一步了，就是把用户输入的编程语言的代码文件，解析成为编译器后面步骤可以理解的东西。</p>

<p>当然，由于涉及的知识相当多，所以前面很长的一部分内容都是用于解释一些基本概念。</p>

<p>首先，我们先来定义一下什么叫做编译器，以及什么是解释器，两者的区别又是什么。</p>

<ul>
<li>编译器就是将一种语言编写的代码转换为另一种语言。譬如 C 语言的编译器把 C 语言的代码转换为汇编代码。</li>
<li>解释器其实也可以说是将一种语言编写的代码转换为另一种语言，譬如 Python 的解释器就是把 Python 代码转换为 C 语言。与编译器不一样的是，这个翻译过程是实时执行代码的，来一句 x+y 就马上转换为 C 语言的 x + y 。</li>
</ul>

<!--more-->

<p>可以说，编译器很像传统的书籍翻译作者，把英文的书翻译成中文的书。 而解释器呢，则更像同声传译，说一句翻译一句。</p>

<p>一般来说，编译器主要包含两个部分，前端和后端，还包括一个中间表示部分，通过中间表示，把前端和后端连接起来。我觉得下面这张图对编译器工作过程说明得挺好的。(注：<a href="http://a1.att.hudong.com/66/70/01300000244176122562704082014.gif">图片来源</a>)</p>

<p><img src="http://b.picphotos.baidu.com/album/s%3D550%3Bq%3D90%3Bc%3Dxiangce%2C100%2C100/sign=dc93e49e39f33a879a6d001ff6676105/b7003af33a87e9503c8094c213385343faf2b48c.jpg?referer=2684eba698504fc2fb488435f482&amp;x=.jpg" alt="compiler">
</p>

<p>其中，各个部分归属如下：</p>

<ul>
<li>词法分析、语法分析和语义分析属于编译前端，这三次分析的过程中，会生成符号存于符号表中，同时在语法和语义分析阶段还会进行诊查处理。</li>
<li>中间代码生成和优化属于中间表示部分，至于什么是中间代码呢，其实就是编译器用一些数据结构表示它处理的代码，譬如四则运算的代码，我们可以用一颗树来表示，然后规定一个遍历顺序，然后直接读取就能进行目标代码的转换了。优化就像字面意思那样啦，就是让生成的代码更加优秀。貌似现在编译器开发的主要工作都集中在这里了。</li>
<li>目标代码生成则属于编译后端了。一般我们所见的编译后端，都是把高级语言转换为低级语言。不过其实是有把低级语言转换为高级语言的编译器的，譬如反编译。</li>
</ul>

<p>符号表是在词法分析，语法分析等过程中，收集、记录和使用源程序中一些语法符号的类型和特征等相关信息。这些信息一般以表格形式存储于系统中，如常数表、变量名表、数组名表、过程名表、标号表等，统称为符号表。对于符号表的组织、构造和管理方法的好坏会直接影响编译系统的运行效率。</p>

<p>大概的定义已经讲解完毕，现在开始将什么是词法分析。龙书是这样定义词法分析的：</p>

<blockquote>
<p>编译器的第一个步骤称为词法分析（lexical analysis）或扫描（scanning）。词法分析器读入组成源程序的字符流，并且将它们组成有意义的词素（lexeme）的序列。对于每个词素，词法分析器产生如下形式的词法单元（token）作为输出：</p>

<ul>
<li>&lt; token-name, attribute-value)</li>
</ul>

<p>在这个词法单元中，第一个分量token-name是一个由语法分析步骤使用的抽象符号，attribute-value则指向符号表中关于这个词法单元的条目。</p>
</blockquote>

<p>上面又是词素，又是词法单元之类的，是不是看得很晕呢？其实对于词素，我现在理解的程度，即它就是一个独立的语法单元，譬如var a = b + 1, 这里 var，a，=， b， +， 1 都是词素。一大串的字符串，其实也只是一个词素。关于词法单元中的抽象符号，这是个事先约定的东西，譬如 a 是一个变量，那么我就用 id 来表示所有的变量。如果 a 是一个函数， 我可以用 func 这个抽象符号来表示。而attribute-value，一般是一个指针，指向符号表代表该词素的数据结构实例那里。</p>

<p>如 var a = b + 1 可能会被分析为： &lt; var&gt; &lt; id, 1&gt; &lt;=&gt; &lt; id,2&gt; &lt;+&gt; &lt; num，1&gt; ，这里var，+，=号都没有带attribute-value，其实也可以带的，看各自实现的需要吧。</p>

<p>其实词法分析器还会做其他的事情，比如把代码里面的空白和注释过滤掉，还有就是记录行数，以便后面的分析发现有错误的时候，可以指出在代码里的哪一行。像 C 语言还有宏的预处理器，其实就是在词法分析这个阶段，把宏代码插入到使用之处。</p>

<p>上面我已经已经把什么是词法分析器将清楚了，现在来关注用什么来实现词法分析器。</p>

<p>据我现在所具备的知识上来看，大部分的词法分析器主要是采用正则语言来实现，这里面涉及很多形式语言、自动机理论的知识，不过我觉得阅读一下我的这两篇文章入门一下就行了，分别是<a href="http://www.shahuwang.com/2013/11/28/%e4%b8%ba%e4%bb%80%e4%b9%88%e6%8b%ac%e5%8f%b7%e4%b8%8d%e6%98%af%e5%8f%af%e6%ad%a3%e5%88%99%e7%9a%84%e8%af%ad%e8%a8%80.html">《为什么括号不是可正则的语言》</a>和<a href="http://www.shahuwang.com/2013/12/31/%e4%bb%80%e4%b9%88%e6%98%af%e6%96%87%e6%b3%95.html">《什么是文法》</a>，就大致明白很多内容了。先根据语言语法的要求，设计一些正则表达式，然后用词法分析器生成器读取这些正则表达式，构造出一个可执行的词法分析器。所谓的词法分析器生成器，就是根据正则表达式，构建自动机，然后把所有语法对应的表达式所构建出来的自动机组合起来，形成一个优化的自动机，生成对应代码，即词法分析器。一些工具，如Lex和Flex，可以说就是这样的东西。</p>

<p>暂时我还不打算一下子就深入去了解学习NFA，DFA等等自动机与词法分析器的构造。我打算先按照本文这样，对编译原理的主要内容进行了解，到以后看机会再深入学习。</p>

        <p/></p>
        <div> 2015-01-24 01:13</div>
		
		<div id="uyan_frame"></div>
		<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1546939"></script>
		
	</body>
</html>
